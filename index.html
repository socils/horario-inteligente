<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Horario Inteligente - Agenda inteligente basada en hora real">
    <meta name="theme-color" content="#302b63">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Horario Inteligente">
    
    <title>Horario Inteligente</title>
    
    <link rel="manifest" href="./manifest.json">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 192 192'><defs><linearGradient id='grad' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' style='stop-color:%23302b63'/><stop offset='100%' style='stop-color:%238e44ad'/></linearGradient></defs><rect width='192' height='192' fill='url(%23grad)'/><text x='96' y='110' font-size='60' font-weight='bold' fill='white' text-anchor='middle' font-family='Arial'>H</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 192 192'><defs><linearGradient id='grad' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' style='stop-color:%23302b63'/><stop offset='100%' style='stop-color:%238e44ad'/></linearGradient></defs><rect width='192' height='192' fill='url(%23grad)'/><text x='96' y='110' font-size='60' font-weight='bold' fill='white' text-anchor='middle' font-family='Arial'>H</text></svg>">
    
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <div class="container">
        <!-- Encabezado con reloj y selecci√≥n de perfil -->
        <div class="header">
            <div class="profile-selector">
                <label for="profileSelect">üë§ Perfil:</label>
                <select id="profileSelect" class="profile-dropdown">
                    <option value="">-- Seleccionar perfil --</option>
                </select>
                <button id="newProfileBtn" class="btn btn-small">+ Nuevo</button>
                <button id="deleteProfileBtn" class="btn btn-small btn-danger" style="display: none;">üóëÔ∏è Eliminar</button>
                <button id="tutorialBtn" class="btn btn-small">‚ùì Tutorial</button>
            </div>
            <div class="clock-container">
                <div id="clock" class="clock">00:00:00</div>
                <div class="date" id="date"></div>
            </div>
        </div>

        <!-- Secci√≥n Principal (oculta hasta seleccionar perfil) -->
        <div id="mainContent" class="main-content" style="display: none;">
            
            <!-- SELECTOR DE D√çA -->
            <div class="card day-selector-card">
                <div class="day-tabs">
                    <button class="day-tab" data-day="1">Lun</button>
                    <button class="day-tab" data-day="2">Mar</button>
                    <button class="day-tab" data-day="3">Mi√©</button>
                    <button class="day-tab" data-day="4">Jue</button>
                    <button class="day-tab" data-day="5">Vie</button>
                    <button class="day-tab" data-day="6">S√°b</button>
                    <button class="day-tab" data-day="0">Dom</button>
                </div>
            </div>

            <!-- INDICADOR DE ACTIVIDAD ACTUAL Y ALERTA -->
            <div id="alertContainer" class="alert-container"></div>

            <!-- BARRA DE PROGRESO -->
            <div id="progressCard" class="card progress-card" style="display: none;">
                <div class="progress-info">
                    <span id="progressActivityName" class="progress-name">Actividad actual</span>
                    <span id="progressTime" class="progress-time">00:00 / 00:00</span>
                </div>
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill"></div>
                </div>
            </div>

            <!-- CONTROL DE ACTIVIDAD ACTUAL -->
            <div class="card control-card">
                <h2>‚è±Ô∏è Actividad Actual</h2>
                <div class="current-activity">
                    <p class="activity-name" id="currentActivityName">Ninguna actividad</p>
                    <p class="activity-time" id="activityTime">--:-- a --:--</p>
                </div>
                <div class="button-group">
                    <button id="startActivityBtn" class="btn btn-primary btn-large">‚ñ∂Ô∏è INICIAR ACTIVIDAD</button>
                </div>
            </div>

            <!-- AGREGAR NUEVA ACTIVIDAD -->
            <div class="card add-activity-card">
                <h3>‚ûï Nueva Actividad</h3>
                <div class="input-group">
                    <input type="text" id="activityName" placeholder="Nombre de la actividad" class="input-field">
                    
                    <div class="time-inputs">
                        <div class="time-group">
                            <label for="activityStart">Hora inicio:</label>
                            <input type="time" id="activityStart" class="input-field">
                        </div>
                        <div class="time-group">
                            <label for="activityEnd">Hora fin:</label>
                            <input type="time" id="activityEnd" class="input-field">
                        </div>
                    </div>

                    <div class="day-selector-input">
                        <label for="activityDay">D√≠a:</label>
                        <select id="activityDay" class="input-field">
                            <option value="1">Lunes</option>
                            <option value="2">Martes</option>
                            <option value="3">Mi√©rcoles</option>
                            <option value="4">Jueves</option>
                            <option value="5">Viernes</option>
                            <option value="6">S√°bado</option>
                            <option value="0">Domingo</option>
                        </select>
                    </div>

                    <button id="addActivityBtn" class="btn btn-success">Agregar</button>
                </div>
            </div>

            <!-- TABLA DE HORARIO -->
            <div class="card schedule-card">
                <h3>üìã Tu Horario</h3>
                <div class="schedule-table-wrapper">
                    <table class="schedule-table">
                        <thead>
                            <tr>
                                <th>Hora Inicio</th>
                                <th>Hora Fin</th>
                                <th>Actividad</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="scheduleTable">
                            <tr>
                                <td colspan="4" class="empty-message">No hay actividades para este d√≠a</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- CONFIGURACI√ìN -->
            <div class="card config-card">
                <h3>‚öôÔ∏è Configuraci√≥n</h3>
                <div class="config-content">
                    <label class="switch">
                        <input type="checkbox" id="breakToggle">
                        <span class="slider"></span>
                    </label>
                    <span class="break-label">Tiempo libre entre actividades</span>
                </div>
                <div class="break-duration" style="display: none;" id="breakDurationContainer">
                    <label for="breakDuration">Minutos:</label>
                    <div class="duration-selector">
                        <button class="duration-btn" data-minutes="5">5</button>
                        <button class="duration-btn" data-minutes="10">10</button>
                        <button class="duration-btn active" data-minutes="15">15</button>
                        <button class="duration-btn" data-minutes="20">20</button>
                    </div>
                </div>
            </div>

            <!-- ESTAD√çSTICAS DE PRODUCTIVIDAD -->
            <div class="card stats-card">
                <h3>üìä Mi Productividad</h3>
                <div class="stats-grid">
                    <div class="stat-box">
                        <span class="stat-label">A tiempo</span>
                        <span class="stat-value" id="statOnTime">0</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Con retraso</span>
                        <span class="stat-value" id="statLate">0</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Promedio retraso</span>
                        <span class="stat-value" id="statAvgDelay">0 min</span>
                    </div>
                </div>
            </div>

            <!-- BOTONES DE ACCI√ìN -->
            <div class="action-buttons">
                <button id="resetDayBtn" class="btn btn-warning btn-small">üîÑ Reiniciar d√≠a</button>
                <button id="resetAllBtn" class="btn btn-danger btn-small">üóëÔ∏è Limpiar todo</button>
            </div>
        </div>

        <!-- Mensaje de bienvenida (cuando no hay perfil seleccionado) -->
        <div id="welcomeMessage" class="welcome-message card">
            <h2>üëã Bienvenido a Horario Inteligente</h2>
            <p>Crea un nuevo perfil o selecciona uno existente para organizar tu semana.</p>
            <button id="quickNewBtn" class="btn btn-primary btn-large">+ Crear Perfil</button>
        </div>
    </div>

    <!-- Modal para crear nuevo perfil -->
    <div id="profileModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Crear Nuevo Perfil</h2>
            <input type="text" id="profileNameInput" placeholder="Nombre del perfil" class="input-field" maxlength="30">
            <div class="modal-buttons">
                <button id="confirmProfileBtn" class="btn btn-success">Crear</button>
                <button id="cancelProfileBtn" class="btn btn-secondary">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal de overlay (fondo oscuro) -->
    <div id="modalOverlay" class="modal-overlay" style="display: none;"></div>

    <!-- Instalador de PWA -->
    <div id="installPrompt" class="install-prompt" style="display: none;">
        <div class="install-content">
            <span>üì± Instalar Horario Inteligente</span>
            <button id="installBtn" class="btn btn-small">Instalar</button>
            <button id="dismissBtn" class="btn btn-small">Descartar</button>
        </div>
    </div>

    <!-- Modal de Tutorial -->
    <div id="tutorialModal" class="modal" style="display: none;">
        <div class="modal-content tutorial-modal-content">
            <div class="tutorial-header">
                <h2>‚ö° Gu√≠a R√°pida - Horario Inteligente v2</h2>
                <button id="closeTutorialBtn" class="btn-close">‚úï</button>
            </div>
            <div class="tutorial-content">
                <!-- Tab navegaci√≥n -->
                <div class="tutorial-tabs">
                    <button class="tutorial-tab active" data-step="0">üéØ Inicio</button>
                    <button class="tutorial-tab" data-step="1">‚ûï Crear Perfil</button>
                    <button class="tutorial-tab" data-step="2">üìã Agregar Actividad</button>
                    <button class="tutorial-tab" data-step="3">‚ñ∂Ô∏è Activar</button>
                    <button class="tutorial-tab" data-step="4">üìä Estad√≠sticas</button>
                </div>

                <!-- Contenido de pasos -->
                <div class="tutorial-steps">
                    <!-- Paso 0: Inicio -->
                    <div class="tutorial-step active" data-step="0">
                        <h3>üéØ Qu√© Cambi√≥ en v2</h3>
                        <ul>
                            <li><strong>v1:</strong> Temporizador manual ‚ùå</li>
                            <li><strong>v2:</strong> Horario autom√°tico por hora real ‚úÖ</li>
                            <li><strong>v1:</strong> Lista de actividades ‚ùå</li>
                            <li><strong>v2:</strong> Tabla tipo horario escolar ‚úÖ</li>
                            <li><strong>NUEVO:</strong> Detecci√≥n autom√°tica de actividad actual</li>
                            <li><strong>NUEVO:</strong> Ajuste autom√°tico por retrasos</li>
                            <li><strong>NUEVO:</strong> Estad√≠sticas de puntualidad</li>
                            <li><strong>NUEVO:</strong> Sistema semanal (7 d√≠as)</li>
                        </ul>
                    </div>

                    <!-- Paso 1: Crear Perfil -->
                    <div class="tutorial-step" data-step="1">
                        <h3>üìå Paso 1: Crear Perfil</h3>
                        <ol>
                            <li>Haz clic en: <code>+ Nuevo</code> o <code>+ Crear Perfil</code></li>
                            <li>Escribe nombre: <code>Mi Semana</code></li>
                            <li>Click: <code>Crear</code></li>
                        </ol>
                        <p><strong>Resultado:</strong> Tu perfil aparecer√° en el selector.</p>
                    </div>

                    <!-- Paso 2: Agregar Actividad -->
                    <div class="tutorial-step" data-step="2">
                        <h3>üìã Paso 2: Agregar Actividad</h3>
                        <p><strong>Formulario: Nueva Actividad</strong></p>
                        <ul>
                            <li><strong>Nombre:</strong> "Estudiar Ingl√©s"</li>
                            <li><strong>Hora Inicio:</strong> 16:00 (4 PM)</li>
                            <li><strong>Hora Fin:</strong> 17:30 (5:30 PM)</li>
                            <li><strong>D√≠a:</strong> Lunes</li>
                        </ul>
                        <p>‚ûú Click: <code>Agregar</code></p>
                    </div>

                    <!-- Paso 3: Activar -->
                    <div class="tutorial-step" data-step="3">
                        <h3>‚ñ∂Ô∏è Paso 3: Detecci√≥n Autom√°tica</h3>
                        <p><strong>Cuando sea la hora (16:00 en este ejemplo):</strong></p>
                        <ul>
                            <li>El sistema <strong>autom√°ticamente</strong> resalta esa fila</li>
                            <li>Aparece un bot√≥n: <code>‚ñ∂Ô∏è INICIAR ACTIVIDAD</code></li>
                            <li>Presiona el bot√≥n</li>
                            <li>Sistema detecta si fuiste puntual o llegaste tarde</li>
                        </ul>
                    </div>

                    <!-- Paso 4: Estad√≠sticas -->
                    <div class="tutorial-step" data-step="4">
                        <h3>üìä Mi Productividad</h3>
                        <p>El sistema autom√°ticamente registra:</p>
                        <ul>
                            <li>‚úÖ Actividades a tiempo</li>
                            <li>‚è∞ Actividades con retraso</li>
                            <li>üìà Promedio de retraso</li>
                            <li>üéØ Ajuste autom√°tico del horario</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="tutorial-footer">
                <button id="prevTutorialBtn" class="btn btn-small">‚Üê Anterior</button>
                <button id="closeTutorialBottomBtn" class="btn btn-small btn-secondary">Cerrar</button>
                <button id="nextTutorialBtn" class="btn btn-small">Siguiente ‚Üí</button>
            </div>
        </div>
    </div>

    <script src="./app.js"></script>
</body>
</html>
